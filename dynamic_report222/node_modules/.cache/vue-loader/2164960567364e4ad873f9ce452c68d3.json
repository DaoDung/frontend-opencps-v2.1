{"remainingRequest":"/Users/binhthgc/Documents/fds/github/frontend-opencps-v2.1/dynamic_report/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/binhthgc/Documents/fds/github/frontend-opencps-v2.1/dynamic_report/src/components/ChiTietThanhToan.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/binhthgc/Documents/fds/github/frontend-opencps-v2.1/dynamic_report/src/components/ChiTietThanhToan.vue","mtime":1548065605825},{"path":"/Users/binhthgc/Documents/fds/github/frontend-opencps-v2.1/dynamic_report/node_modules/vuetify-loader/lib/loader.js","mtime":499162500000},{"path":"/Users/binhthgc/Documents/fds/github/frontend-opencps-v2.1/dynamic_report/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/binhthgc/Documents/fds/github/frontend-opencps-v2.1/dynamic_report/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\nimport Vue from 'vue'\nexport default {\n  props: {\n    payments: {\n      type: Object,\n      default: () => {}\n    },\n    dossierDetail: {\n      type: Object,\n      default: () => {}\n    }\n  },\n  components: {},\n  data: () => ({\n    loading: true,\n    loadingAction: false,\n    paymentFile: '',\n    dialogPDF: false,\n    dialogPDFLoading: true,\n    activePrintPay: false\n  }),\n  computed: {\n    paymentFileName () {\n      return this.$store.getters.getPaymentFileName\n    },\n    originality () {\n      var vm = this\n      return vm.getOriginality()\n    }\n  },\n  created () {\n    let vm = this\n    vm.$nextTick(function () {\n      var vm = this\n      let query = vm.$router.history.current.query\n    })\n  },\n  watch: {\n    dossierDetail (val) {\n      var vm = this\n      let filter = vm.dossierDetail\n      console.log('filterFile', filter)\n      vm.$store.dispatch('getPaymentFiles', filter).then(result => {\n        vm.paymentFile = result\n      })\n    }\n  },\n  methods: {\n    currency (value) {\n      if (value) {\n        let moneyCur = (value / 1).toFixed(0).replace('.', ',')\n        return moneyCur.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.')\n      }\n      return ''\n    },\n    viewFile () {\n      let vm = this\n      vm.activePrintPay = false\n      vm.dialogPDFLoading = true\n      vm.dialogPDF = true\n      let filter = {\n        dossierId: vm.dossierDetail.dossierId,\n        referenceUid: vm.dossierDetail.referenceUid\n      }\n      vm.$store.dispatch('viewPaymentFile', filter).then(result => {\n        vm.dialogPDFLoading = false\n        document.getElementById('dialogPreview').src = result\n      })\n    },\n    downloadPaymentFile (item) {\n      let vm = this\n      // test local\n      // let url = 'http://127.0.0.1:8081/api/dossiers/' + vm.dossierId + '/payment/confirmfile'\n      let url = '/o/rest/v2/dossiers/' + vm.dossierDetail.dossierId + '/payments/' + vm.dossierDetail.referenceUid + '/confirmfile'\n      window.open(url)\n    },\n    printPay () {\n      let vm = this\n      vm.activePrintPay = true\n      let filter = {\n        dossierId: vm.dossierDetail.dossierId,\n        referenceUid: vm.payments.referenceUid\n      }\n      vm.dialogPDFLoading = true\n      vm.dialogPDF = true\n      vm.$store.dispatch('printPay', filter).then(function (result) {\n        vm.dialogPDFLoading = false\n        document.getElementById('dialogPreview').src = result\n      })\n    },\n    getEinvoiceNo (string) {\n      if (string && string.indexOf('#') >= 0) {\n        let eInvoiceNo = string.split('#')[1] ? string.split('#')[1] : ''\n        return eInvoiceNo.indexOf('}') < 0 && eInvoiceNo.indexOf('\"') < 0 ? eInvoiceNo : ''\n      } else {\n        return ''\n      }\n    },\n    getEinvoiceCode (string) {\n      if (string && string.indexOf('#') >= 0) {\n        let eInvoiceCode = string.split('#')[3] ? string.split('#')[3].split(',')[0].replace('\"', '') : ''\n        return eInvoiceCode\n      } else {\n        return ''\n      }\n    },\n    tracuuhoadon () {\n      window.open('http://tracuu.cmcsoft.com', '_blank')\n    },\n    getPaymentStatus (code) {\n      if (code === 1 || code === '1') {\n        return 'Yêu cầu nộp tiền tạm ứng '\n      } else if (code === 2 || code === '2') {\n        return 'Yêu cầu quyết toán phí'\n      } else if (code === 3 || code === '3') {\n        return 'Báo đã nộp phí trực tuyến'\n      } else if (code === 3 || code === '4') {\n        return 'Yêu cầu nộp lại phí trực tuyến'\n      } else if (code === 5 || code === '5') {\n        return 'Xác nhận hoàn thành thu phí'\n      } else {\n        return ''\n      }\n    }\n  }\n}\n",{"version":3,"sources":["ChiTietThanhToan.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ChiTietThanhToan.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <v-card>\n      <v-expansion-panel :value=\"[true]\" class=\"expansion-pl\">\n        <v-expansion-panel-content>\n          <div slot=\"header\">\n            <div class=\"background-triangle-small\"> \n              <v-icon size=\"18\" color=\"white\">star_rate</v-icon> \n            </div>\n            <span>Thông tin thanh toán</span>\n          </div>\n          <v-card class=\"\">\n            <v-card-text class=\"px-0 py-0\">\n              <v-layout wrap>\n                <v-flex xs12 sm2>\n                  <v-subheader class=\"pl-0 text-right\">Lệ phí: </v-subheader>\n                </v-flex>\n                <v-flex xs12 sm2>\n                  <p class=\"pt-2 mb-0\">{{payments.feeAmount ? currency(payments.feeAmount.toString().replace(/\\./g, '')) : 0}} &nbsp;&nbsp; vnđ</p>\n                </v-flex>\n                <v-flex xs12 sm2 class=\"pt-1\">\n                  <v-subheader class=\"pl-0 text-right\">Phí: </v-subheader>\n                </v-flex>\n                <v-flex xs12 sm3 class=\"pt-1\">\n                  <p class=\"pt-2 mb-0\">{{payments.serviceAmount ? currency(payments.serviceAmount.toString().replace(/\\./g, '')) : 0}} &nbsp;&nbsp; vnđ</p>\n                </v-flex>\n                <v-flex xs12 sm3></v-flex>\n                <!--  -->\n                <v-flex xs12 sm2 v-if=\"(dossierDetail.viaPortal === 2 || dossierDetail.viaPortal === '2') && payments.shipAmount !== 0\">\n                  <v-subheader class=\"pl-0 text-right\">Phí chuyển phát: </v-subheader>\n                </v-flex>\n                <v-flex xs12 sm2 v-if=\"(dossierDetail.viaPortal === 2 || dossierDetail.viaPortal === '2') && payments.shipAmount !== 0\">\n                  <p class=\"pt-2 mb-0\">{{payments.shipAmount ? currency(payments.shipAmount.toString().replace(/\\./g, '')) : 0}} &nbsp;&nbsp; vnđ</p>\n                </v-flex>\n                <v-flex xs12 sm8 v-if=\"(dossierDetail.viaPortal === 2 || dossierDetail.viaPortal === '2') && payments.shipAmount !== 0\"></v-flex>\n                <!--  -->\n                <v-flex xs12 sm2>\n                  <v-subheader class=\"pl-0 text-right\"><span class=\"text-bold\">Tổng: </span></v-subheader>\n                </v-flex>\n                <v-flex xs12 sm3 style=\"padding-top:7px\">\n                  <span>{{payments.paymentAmount ? currency(payments.paymentAmount.toString().replace(/\\./g, '')) : 0}} &nbsp;&nbsp; vnđ</span>\n                </v-flex>\n                <v-flex xs12 sm7></v-flex>\n                <!--  -->\n                <v-flex style=\"width:100px\" class=\"my-0 pl-3 py-1\"><span class=\"red--text\">* </span>&nbsp;Ghi chú:</v-flex>\n                <v-flex style=\"width:calc(100% - 100px)\">\n                  <p class=\"px-2 my-0 py-1\">\n                    {{payments.paymentNote ? payments.paymentNote : ''}} &nbsp;&nbsp;\n                  </p>\n                </v-flex>\n              </v-layout>\n            </v-card-text>\n          </v-card>\n        </v-expansion-panel-content>\n      </v-expansion-panel>\n      <v-expansion-panel :value=\"[true]\" class=\"expansion-pl\">\n        <v-expansion-panel-content>\n          <div slot=\"header\">\n            <div class=\"background-triangle-small\"> \n              <v-icon size=\"18\" color=\"white\">star_rate</v-icon> \n            </div>\n            <span>Tình trạng thanh toán</span>\n          </div>\n          <v-card class=\"\">\n            <v-card-text class=\"px-0 py-0\">\n              <v-layout wrap>\n                <v-flex xs12 sm2>\n                  <v-subheader class=\"pl-0 text-right\">Trạng thái: </v-subheader>\n                </v-flex>\n                <v-flex xs12 sm3>\n                  <p class=\"pt-2 mb-0\">{{getPaymentStatus(payments.paymentStatus)}}</p>\n                </v-flex>\n                <v-flex xs12 sm7></v-flex>\n                <v-layout wrap v-if=\"Number(payments.paymentStatus) >= 3\">\n                  <v-flex xs12 sm2>\n                    <v-subheader class=\"pl-0 text-right\">Hình thức thanh toán: </v-subheader>\n                  </v-flex>\n                  <v-flex xs12 sm3>\n                    <p class=\"pt-2 mb-0\">{{payments.paymentMethod}}</p>\n                  </v-flex>\n                  <v-flex xs12 sm7></v-flex>\n                  <v-flex xs12 sm2 v-if=\"paymentFile\">\n                    <v-subheader class=\"pl-0 text-right\">Chứng từ kèm theo: </v-subheader>\n                  </v-flex>\n                  <v-flex xs12 sm10 v-if=\"paymentFile\" >\n                    <span v-on:click.stop=\"viewFile()\" style=\"cursor: pointer;\">\n                      <v-icon>attach_file</v-icon>\n                      {{paymentFileName}}\n                    </span>\n                    <v-tooltip top>\n                      <v-btn icon ripple slot=\"activator\" v-on:click.stop=\"downloadPaymentFile(item)\" class=\"mx-0 my-0\">\n                        <v-icon style=\"color: #0d71bb;\" size=\"16\" color=\"primary\">save_alt</v-icon>\n                      </v-btn>\n                      <span>Tải xuống</span>\n                    </v-tooltip>\n                  </v-flex>\n                </v-layout>\n              </v-layout>\n            </v-card-text>\n          </v-card>\n        </v-expansion-panel-content>\n      </v-expansion-panel>\n      <!--  -->\n      <v-expansion-panel :value=\"[true]\" class=\"expansion-pl\" v-if=\"Number(payments.paymentStatus) >= 3\">\n        <v-expansion-panel-content>\n          <div slot=\"header\">\n            <div class=\"background-triangle-small\"> \n              <v-icon size=\"18\" color=\"white\">star_rate</v-icon> \n            </div>\n            <span>Hóa đơn thanh toán</span>\n          </div>\n          <v-card class=\"pl-2\">\n            <v-card-text class=\"px-0 py-0\">\n              <v-layout wrap>\n                <v-flex xs12 sm2>\n                  <v-subheader class=\"pl-0 text-right\">Mẫu số hóa đơn : </v-subheader>\n                </v-flex>\n                <v-flex xs12 sm3>\n                  <p class=\"pt-2 mb-0\">{{payments.invoiceTemplateNo}}</p>\n                </v-flex>\n                <v-flex xs12 sm2>\n                  <v-subheader class=\"pl-0 text-right\">Ký hiệu hóa đơn : </v-subheader>\n                </v-flex>\n                <v-flex xs12 sm3>\n                  <p class=\"pt-2 mb-0\">{{payments.invoiceIssueNo}}</p>\n                </v-flex>\n                <v-flex xs12 sm2></v-flex>\n                <v-flex xs12 sm2>\n                  <v-subheader class=\"pl-0 text-right\">Số hóa đơn trên hệ thống : </v-subheader>\n                </v-flex>\n                <v-flex xs12 sm3>\n                  <p class=\"pt-2 mb-0\">{{getEinvoiceNo(payments.einvoice)}}</p>\n                </v-flex>\n                <v-flex xs12 sm2>\n                  <v-subheader class=\"pl-0 text-right\">Mã tra cứu trên hệ thống : </v-subheader>\n                </v-flex>\n                <v-flex xs12 sm3>\n                  <p class=\"pt-2 mb-0\">{{getEinvoiceCode(payments.einvoice)}}</p>\n                </v-flex>\n                <v-flex xs12 sm2></v-flex>\n                <v-flex xs12 sm12 class=\"mb-3\">\n                  <v-btn color=\"primary\" @click=\"tracuuhoadon()\">\n                    <v-icon>search</v-icon> \n                    Tra cứu hóa đơn\n                  </v-btn>\n                  <v-btn v-if=\"originality === 3\" class=\"ml-3\" color=\"primary\" @click=\"printPay()\">\n                    <v-icon>print</v-icon> &nbsp;\n                    In biên lai\n                  </v-btn>\n                </v-flex>\n              </v-layout>\n            </v-card-text>\n          </v-card>\n        </v-expansion-panel-content>\n      </v-expansion-panel>\n    </v-card>\n    <v-dialog v-model=\"dialogPDF\" max-width=\"900\" transition=\"fade-transition\" style=\"overflow: hidden;\">\n      <v-card>\n        <v-card-title class=\"headline\" v-if=\"!activePrintPay\">File đính kèm</v-card-title>\n        <v-card-title class=\"headline\" v-else>In biên lai thanh toán</v-card-title>\n        <v-btn icon dark class=\"mx-0 my-0 absolute__btn_panel mr-2\" @click.native=\"dialogPDF = false\">\n          <v-icon>clear</v-icon>\n        </v-btn>\n        <div v-if=\"dialogPDFLoading\" style=\"\n          min-height: 600px;\n          text-align: center;\n          margin: auto;\n          padding: 25%;\n        \">\n          <v-progress-circular\n            :size=\"100\"\n            :width=\"1\"\n            color=\"primary\"\n            indeterminate\n          ></v-progress-circular>\n        </div>\n        <iframe v-show=\"!dialogPDFLoading\" id=\"dialogPreview\" src=\"\" type=\"application/pdf\" width=\"100%\" height=\"100%\" style=\"overflow: auto;min-height: 600px;\" frameborder=\"0\">\n        </iframe>\n      </v-card>\n    </v-dialog>\n  </div>\n</template>\n\n<script>\n\nimport Vue from 'vue'\nexport default {\n  props: {\n    payments: {\n      type: Object,\n      default: () => {}\n    },\n    dossierDetail: {\n      type: Object,\n      default: () => {}\n    }\n  },\n  components: {},\n  data: () => ({\n    loading: true,\n    loadingAction: false,\n    paymentFile: '',\n    dialogPDF: false,\n    dialogPDFLoading: true,\n    activePrintPay: false\n  }),\n  computed: {\n    paymentFileName () {\n      return this.$store.getters.getPaymentFileName\n    },\n    originality () {\n      var vm = this\n      return vm.getOriginality()\n    }\n  },\n  created () {\n    let vm = this\n    vm.$nextTick(function () {\n      var vm = this\n      let query = vm.$router.history.current.query\n    })\n  },\n  watch: {\n    dossierDetail (val) {\n      var vm = this\n      let filter = vm.dossierDetail\n      console.log('filterFile', filter)\n      vm.$store.dispatch('getPaymentFiles', filter).then(result => {\n        vm.paymentFile = result\n      })\n    }\n  },\n  methods: {\n    currency (value) {\n      if (value) {\n        let moneyCur = (value / 1).toFixed(0).replace('.', ',')\n        return moneyCur.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.')\n      }\n      return ''\n    },\n    viewFile () {\n      let vm = this\n      vm.activePrintPay = false\n      vm.dialogPDFLoading = true\n      vm.dialogPDF = true\n      let filter = {\n        dossierId: vm.dossierDetail.dossierId,\n        referenceUid: vm.dossierDetail.referenceUid\n      }\n      vm.$store.dispatch('viewPaymentFile', filter).then(result => {\n        vm.dialogPDFLoading = false\n        document.getElementById('dialogPreview').src = result\n      })\n    },\n    downloadPaymentFile (item) {\n      let vm = this\n      // test local\n      // let url = 'http://127.0.0.1:8081/api/dossiers/' + vm.dossierId + '/payment/confirmfile'\n      let url = '/o/rest/v2/dossiers/' + vm.dossierDetail.dossierId + '/payments/' + vm.dossierDetail.referenceUid + '/confirmfile'\n      window.open(url)\n    },\n    printPay () {\n      let vm = this\n      vm.activePrintPay = true\n      let filter = {\n        dossierId: vm.dossierDetail.dossierId,\n        referenceUid: vm.payments.referenceUid\n      }\n      vm.dialogPDFLoading = true\n      vm.dialogPDF = true\n      vm.$store.dispatch('printPay', filter).then(function (result) {\n        vm.dialogPDFLoading = false\n        document.getElementById('dialogPreview').src = result\n      })\n    },\n    getEinvoiceNo (string) {\n      if (string && string.indexOf('#') >= 0) {\n        let eInvoiceNo = string.split('#')[1] ? string.split('#')[1] : ''\n        return eInvoiceNo.indexOf('}') < 0 && eInvoiceNo.indexOf('\"') < 0 ? eInvoiceNo : ''\n      } else {\n        return ''\n      }\n    },\n    getEinvoiceCode (string) {\n      if (string && string.indexOf('#') >= 0) {\n        let eInvoiceCode = string.split('#')[3] ? string.split('#')[3].split(',')[0].replace('\"', '') : ''\n        return eInvoiceCode\n      } else {\n        return ''\n      }\n    },\n    tracuuhoadon () {\n      window.open('http://tracuu.cmcsoft.com', '_blank')\n    },\n    getPaymentStatus (code) {\n      if (code === 1 || code === '1') {\n        return 'Yêu cầu nộp tiền tạm ứng '\n      } else if (code === 2 || code === '2') {\n        return 'Yêu cầu quyết toán phí'\n      } else if (code === 3 || code === '3') {\n        return 'Báo đã nộp phí trực tuyến'\n      } else if (code === 3 || code === '4') {\n        return 'Yêu cầu nộp lại phí trực tuyến'\n      } else if (code === 5 || code === '5') {\n        return 'Xác nhận hoàn thành thu phí'\n      } else {\n        return ''\n      }\n    }\n  }\n}\n</script>\n"]}]}